top_n(2, wt = tackles)
tackles_by_player
tackles_by_player <- tournament_data %>%
group_by(player_name, team) %>%
summarise(tackles = sum(tackles)) %>%
top_n(2, wt = tackles)
tackles_by_player
tackles_by_player <- tournament_data %>%
group_by(player_name, team) %>%
summarise(tackles = sum(tackles))
?head
tackles_by_player
tackles_by_player %>% top(2)
tackles_by_player %>% top_n(10)
tackles_by_player %>% top_n(5)
?top_n
top_n(tackles_by_player)
top_n(tackles_by_player, 10)
top_n(tackles_by_player, 5)
top_n(tackles_by_player, n = 5)
top_n(tackles_by_player, n = 5, wt = tackles)
top_n(tackles_by_player, n = 3, wt = tackles)
top_n(tackles_by_player, n = 10, wt = tackles)
tackles_by_player <- tournament_data %>%
group_by(player_name, team) %>%
summarise(tackles = sum(tackles))
top_n(tackles_by_player, n = 10, wt = tackles)
top_n(tackles_by_player, 10, n)
library(tidyverse)
library(gridExtra)
tournament_data = read.csv(file = 'data/tournament.csv')
# Variables
sort(names(tournament_data))
tackles_by_player <- tournament_data %>%
group_by(player_name, team) %>%
summarise(tackles = sum(tackles))
top_n(tackles_by_player, 10, n)
tackles_by_player <- tournament_data %>% group_by(player_name, team) %>% summarise(tackles = sum(tackles))
summarise(tackles = sum(tackles))
tackles_by_player <- tournament_data %>%
group_by(player_name, team) %>%
summarise(tackles = sum(tackles)) %>%
top_n(10)
summary(tackles_by_player)
tournament_data %>%
group_by(player_name)
tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles))
tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(10)
tackles_by_player <- tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(10, wt = tackles)
summary(tackles_by_player)
tackles_by_player
top_20_tackles_by_player <- tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles)
top_20_tackles_by_player
sort(top_20_tackles_by_player, tackles)
names(top_20_tackles_by_player)
sort(top_20_tackles_by_player, 'tackles'))
sort(top_20_tackles_by_player, 'tackles')
sort(top_20_tackles_by_player, top_20_tackles_by_player$tackles)
names(top_20_tackles_by_player)
sort(top_20_tackles_by_player, top_20_tackles_by_player$tackles)
top_20_tackles_by_player
top_20_tackles_by_player <- tournament_data %>%
group_by(player_name, team) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles)
names(top_20_tackles_by_player)
top_20_tackles_by_player
top_20_tackles_by_player <- tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles)
names(top_20_tackles_by_player)
top_20_tackles_by_player
top_20_tackles_by_player <- tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles) %>% order('tackles')
tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles) %>%
order('tackles')
top_20_tackles_by_player <- tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles)
names(top_20_tackles_by_player)
top_20_tackles_by_player <- tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles)
names(top_20_tackles_by_player)
top_20_tackles_by_player
sort(top_20_tackles_by_player)
sort(top_20_tackles_by_player, decreasing = TRUE)
sort(top_20_tackles_by_player$tackles, decreasing = TRUE)
sort(top_20_tackles, top_20_tackles_by_player$tackles, decreasing = TRUE)
sort(top_20_tackles_by_player, top_20_tackles_by_player$tackles, decreasing = TRUE)
top_20_tackles_by_player %>% sort(top_20_tackles_by_player$tackles, decreasing = TRUE)
top_20_tackles_by_player %>% sort(top_20_tackles_by_player$tackles, decreasing = TRUE)
top_20_tackles_by_player %>% sort(tackles, decreasing = TRUE)
top_20_tackles_by_player
top_20_tackles_by_player <- tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles)
top_20_tackles_by_player %>% sort(tackles, decreasing = TRUE)
top_20_tackles_by_player <- tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles)
top_20_tackles_by_player %>% sort(tackles, decreasing = TRUE)
top_20_tackles_by_player <- tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles)
top_20_tackles_by_player
top_20_tackles_by_player %>% order(tackles)
library(tidyverse)
library(gridExtra)
tournament_data = read.csv(file = 'data/tournament.csv')
# Variables
sort(names(tournament_data))
# Tackles
top_20_tackles_by_player <- tournament_data %>%
group_by(player_name) %>%
summarise(tackles = sum(tackles)) %>%
top_n(20, wt = tackles)
top_20_tackles_by_player %>% order(tackles)
library(tidyverse)
library(gridExtra)
tournament_data = read.csv(file = 'data/tournament.csv')
# Variables
metric_names = sort(names(tournament_data))
metric_names[grep('turn', metric_names)]
# Tackles
tackles_by_player <- tournament_data %>%
group_by(team, player_name) %>%
summarise(tackles = sum(tackles),
missed_tackles = sum(missed_tackles),
tackle_success = mean(tackle_success),
matches = n(),
game_minutes = sum(minutes_played_total),
tackles_per_game = tackles / matches
) %>%
arrange(desc(tackle_success)) %>%
filter(tackles > 50)
nrow(tackles_by_player)
head(tackles_by_player, n = 20, wt = tackle_success)
View(tackles_by_player)
carries_by_player <- tournament_data %>%
group_by(team, player_name) %>%
summarise(carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
carries_not_made_gain_line = sum(carries_not_made_gain_line),
carries_support = sum(carries_support),
carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support,
matches = n(),
game_minutes = sum(minutes_played_total),
gain_no_gain = carries_crossed_gain_line / carries_not_made_gain_line,
meters_per_carry = carries_metres / carries
) %>%
arrange(desc(carries)) %>%
filter(carries > 50)
nrow(carries_by_player)
head(carries_by_player, n = 20, wt = carries) %>% select(player_name, carries, meters_per_carry)
View(carries_by_player)
View(tackles_by_player)
library(tidyverse)
library(gridExtra)
tournament_data = read.csv(file = 'data/tournament.csv')
# Variables
metric_names = sort(names(tournament_data))
metric_names[grep('turn', metric_names)]
# Tackles
tackles_by_player <- tournament_data %>%
group_by(team, player_name) %>%
summarise(tackles = sum(tackles),
missed_tackles = sum(missed_tackles),
tackle_success = mean(tackle_success),
matches = n(),
game_minutes = sum(minutes_played_total),
tackles_per_game = tackles / matches
) %>%
arrange(desc(tackle_success)) %>%
filter(tackles > 50)
# Carries
carries_by_player <- tournament_data %>%
group_by(team, player_name) %>%
summarise(carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
carries_not_made_gain_line = sum(carries_not_made_gain_line),
carries_support = sum(carries_support),
carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support,
matches = n(),
game_minutes = sum(minutes_played_total),
gain_no_gain = carries_crossed_gain_line / carries_not_made_gain_line,
meters_per_carry = carries_metres / carries
) %>%
arrange(desc(carries)) %>%
filter(carries > 50)
nrow(carries_by_player)
head(carries_by_player, n = 20, wt = carries) %>% select(player_name, carries, meters_per_carry)
# Offload
offloads_by_player <- tournament_data %>%
group_by(team, player_name) %>%
summarise(offload = sum(offload),
matches = n(),
game_minutes = sum(minutes_played_total)
) %>%
arrange(desc(offload))
# Passes
passes_by_player <- tournament_data %>%
group_by(team, player_name) %>%
summarise(passes = sum(passes),
bad_passes = sum(bad_passes),
matches = n(),
game_minutes = sum(minutes_played_total)
) %>%
arrange(desc(passes))
# Turnovers
turnovers_by_player <- tournament_data %>%
group_by(team, player_name) %>%
summarise(
turnover_won = sum(turnover_won),
turnovers_conceded = sum(turnovers_conceded)
) %>% arrange(desc(turnovers_conceded))
View(turnovers_by_player)
View(offloads_by_player)
library(tidyverse)
library(gridExtra)
tournament_data = read.csv(file = 'data/tournament.csv')
# Variables
metric_names = sort(names(tournament_data))
metric_names[grep('turn', metric_names)]
# Tackles
tackles_by_player <- tournament_data %>%
group_by(team, player_name) %>%
summarise(tackles = sum(tackles),
missed_tackles = sum(missed_tackles),
tackle_success = mean(tackle_success),
matches = n(),
game_minutes = sum(minutes_played_total),
tackles_per_game = tackles / matches
) %>%
arrange(desc(tackle_success)) %>%
filter(tackles > 50)
library(tidyverse)
library(gridExtra)
tournament_data = read.csv(file = 'data/tournament.csv')
View(tournament_data)
# Tackles
tackles_by_player <- tournament_data %>%
group_by(team, position, player_name) %>%
summarise(tackles = sum(tackles),
missed_tackles = sum(missed_tackles),
tackle_success = mean(tackle_success),
matches = n(),
game_minutes = sum(minutes_played_total),
tackles_per_game = tackles / matches
) %>%
arrange(desc(tackle_success)) %>%
filter(tackles > 50)
View(tackles_by_player)
carries_by_player <- tournament_data %>%
group_by(team, position, player_name) %>%
summarise(carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
carries_not_made_gain_line = sum(carries_not_made_gain_line),
carries_support = sum(carries_support),
carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support,
matches = n(),
game_minutes = sum(minutes_played_total),
gain_no_gain = carries_crossed_gain_line / carries_not_made_gain_line,
meters_per_carry = carries_metres / carries
) %>%
arrange(desc(carries)) %>%
filter(carries > 50)
nrow(carries_by_player)
head(carries_by_player, n = 20, wt = carries) %>% select(player_name, carries, meters_per_carry)
View(carries_by_player)
turnovers_by_player <- tournament_data %>%
group_by(team, player_name) %>%
summarise(
turnover_won = sum(turnover_won),
turnovers_conceded = sum(turnovers_conceded)
) %>% arrange(desc(turnovers_conceded))
View(turnovers_by_player)
turnovers_by_player <- tournament_data %>%
group_by(team, position, player_name) %>%
summarise(
turnover_won = sum(turnover_won),
turnovers_conceded = sum(turnovers_conceded)
) %>% arrange(desc(turnovers_conceded))
tournament_data %>% mutate(position_type = str_split(position)[[1]])
tournament_data %>% mutate(position_type = strsplit(position)[[1]])
tournament_data %>% mutate(position_type = strsplit(position))
tournament_data %>% mutate(position_type = strsplit(position, ' ')[[1]])
tournament_data %>% mutate(position_type = seperate(position, ' ')[[1]])
tournament_data %>% mutate(position_type = separate(position, ' ')[[1]])
tournament_data %>% separate(position)
tournament_data %>% separate(position, c('position_type', 'position_numnber'))
View(tournament_data)
new_something <- tournament_data %>% separate(position, c('position_type', 'position_numnber'))
View(new_something)
library(tidyverse)
library(gridExtra)
tournament_data = read.csv(file = 'data/tournament.csv')
# Add position type and position number
tournament_data <- tournament_data %>% separate(position, c('position_type', 'position_numnber'))
tackles_by_player <- tournament_data %>%
group_by(team, position_type, player_name) %>%
summarise(tackles = sum(tackles),
missed_tackles = sum(missed_tackles),
tackle_success = mean(tackle_success),
matches = n(),
game_minutes = sum(minutes_played_total),
tackles_per_game = tackles / matches
) %>%
arrange(desc(tackle_success)) %>%
filter(tackles > 50)
View(tackles_by_player)
tackles_by_player <- tournament_data %>%
group_by(team, position_type, player_name) %>%
summarise(tackles = sum(tackles),
missed_tackles = sum(missed_tackles),
tackle_success = mean(tackle_success),
matches = n(),
game_minutes = sum(minutes_played_total),
tackles_per_game = tackles / matches
) %>%
arrange(desc(tackle_success))
View(tackles_by_player)
carries_by_player <- tournament_data %>%
group_by(team, position_type, player_name) %>%
summarise(carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
carries_not_made_gain_line = sum(carries_not_made_gain_line),
carries_support = sum(carries_support),
carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support,
matches = n(),
game_minutes = sum(minutes_played_total),
gain_no_gain = carries_crossed_gain_line / carries_not_made_gain_line,
meters_per_carry = carries_metres / carries
) %>%
arrange(desc(carries))
View(carries_by_player)
offloads_by_player <- tournament_data %>%
group_by(team, position_type, player_name) %>%
summarise(offload = sum(offload),
matches = n(),
game_minutes = sum(minutes_played_total)
) %>%
arrange(desc(offload))
View(offloads_by_player)
passes_by_player <- tournament_data %>%
group_by(team, position_type, player_name) %>%
summarise(passes = sum(passes),
bad_passes = sum(bad_passes),
matches = n(),
game_minutes = sum(minutes_played_total)
) %>%
arrange(desc(passes))
View(passes_by_player)
View(offloads_by_player)
tries_by_player <- tournament_data %>% group_by(team,position_type) %>%
summarise(tries = sum(tries))
View(tries_by_player)
tries_by_team_squad <- tournament_data %>% group_by(team,position_type) %>%
summarise(tries = sum(tries))
tries_by_team_squad <- tournament_data %>% group_by(team) %>%
summarise(tries = sum(tries))
View(tries_by_team_squad)
tries_by_team_squad <- tournament_data %>% group_by(team, opposition, position_type) %>%
summarise(tries = sum(tries))
tries_by_team_squad <- tournament_data %>% group_by(team, opposition, position_type, player_name) %>%
summarise(tries = sum(tries))
tries_by_team_squad <- tournament_data %>% group_by(team, opposition, position_type, player_name) %>%
summarise(tries = sum(tries)) %>% arrange(opposition, tries)
tries_by_team_squad <- tournament_data %>% group_by(team, opposition, position_type) %>%
summarise(tries = sum(tries)) %>% arrange(opposition, tries)
tries_by_team_squad <- tournament_data %>% group_by(team, position_type) %>%
summarise(tries = sum(tries)) %>% arrange(opposition, tries)
tries_by_team_squad <- tournament_data %>% group_by(team, position_type) %>%
summarise(tries = sum(tries))
tries_by_team_squad <- tournament_data %>% group_by(team, position_type, opposition) %>%
summarise(tries = sum(tries))
carries_by_team_squad <- tournament_data %>% group_by(team, position_type, opposition) %>%
summarise(carries = sum(carries))
carries_by_team_squad <- tournament_data %>% group_by(team, position_type, opposition) %>%
summarise(carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support)
carries_by_team_squad <- tournament_data %>% group_by(team, position_type, opposition) %>%
summarise(
carries_crossed_gain_line = sum(carries_crossed_gain_line),
carries_not_made_gain_line = sum(carries_not_made_gain_line),
carries_support = sum(carries_support),
carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support)
View(carries_by_team_squad)
carries_by_team_squad <- tournament_data %>% group_by(team, position_type) %>%
summarise(
carries_crossed_gain_line = sum(carries_crossed_gain_line),
carries_not_made_gain_line = sum(carries_not_made_gain_line),
carries_support = sum(carries_support),
carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support)
tries_by_team_squad <- tournament_data %>% group_by(team, position_type, opposition) %>%
summarise(tries = sum(tries))
View(tries_by_team_squad)
tries_by_team_squad <- tournament_data %>% group_by(team, position_type) %>%
summarise(tries = sum(tries))
View(carries_by_team_squad)
effect_by_position <- tournament_data %>% group_by(team, position_type) %>%
summarise(tries = sum(tries),
carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line)
)
View(effect_by_position)
effect_by_position <- tournament_data %>% group_by(team, position_type) %>%
summarise(tries = sum(tries),
carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
tackles = sum(tackles),
missed_tackles = sum(missed_tackles),
tackle_success = mean(tackle_success),
game_minutes = sum(minutes_played_total)
)
effect_of_replacements <- tournament_data %>% group_by(team, position_type) %>%
summarise(tries = sum(tries),
carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
tackles = sum(tackles),
missed_tackles = sum(missed_tackles),
tackle_success = mean(tackle_success),
game_minutes = sum(minutes_played_total)
)
effect_of_replacements <- tournament_data %>% filter(position_type = 'Replacement') %>% group_by(team, position_type) %>%
summarise(tries = sum(tries),
carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
tackles = sum(tackles),
missed_tackles = sum(missed_tackles),
tackle_success = mean(tackle_success),
game_minutes = sum(minutes_played_total)
)
effect_of_replacements <- tournament_data %>% filter(position_type == 'Replacement') %>% group_by(team, position_type) %>%
summarise(tries = sum(tries),
carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
tackles = sum(tackles),
missed_tackles = sum(missed_tackles),
tackle_success = mean(tackle_success),
game_minutes = sum(minutes_played_total)
)
View(effect_of_replacements)
effect_of_replacements <- tournament_data %>% filter(position_type == 'Replacement') %>% group_by(team, position_type) %>%
summarise(tries = sum(tries),
carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
carries_not_made_gain_line = sum(carries_not_made_gain_line),
carries_support = sum(carries_support),
carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support,
tackles = sum(tackles),
game_minutes = sum(minutes_played_total)
)
metric_names
effect_of_replacements <- tournament_data %>% filter(position_type == 'Replacement') %>% group_by(team, position_type) %>%
summarise(tries = sum(tries),
carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
carries_not_made_gain_line = sum(carries_not_made_gain_line),
carries_support = sum(carries_support),
carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support,
tackles = sum(tackles),
clean_breaks = sum(clean_breaks),
game_minutes = sum(minutes_played_total)
)
effect_of_replacements <- tournament_data %>% filter(position_type == 'Replacement') %>% group_by(team, position_type) %>%
summarise(tries = sum(tries),
carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
carries_not_made_gain_line = sum(carries_not_made_gain_line),
carries_support = sum(carries_support),
carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support,
tackles = sum(tackles),
bad_passes = sum(bad_passes),
handling_error = sum(handling_error),
metres = sum(metres),
clean_breaks = sum(clean_breaks),
game_minutes = sum(minutes_played_total)
)
effect_of_replacements <- tournament_data %>% filter(position_type == 'Replacement') %>% group_by(team, position_type) %>%
summarise(tries = sum(tries),
carries_metres = sum(carries_metres),
carries_crossed_gain_line = sum(carries_crossed_gain_line),
carries_not_made_gain_line = sum(carries_not_made_gain_line),
carries_support = sum(carries_support),
carries = carries_crossed_gain_line + carries_not_made_gain_line + carries_support,
handling_error = sum(handling_error),
clean_breaks = sum(clean_breaks),
offload = sum(offload),
game_minutes = sum(minutes_played_total)
)
